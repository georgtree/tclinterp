<!DOCTYPE html><html><head><meta charset="utf-8"/>
<title>Tcl wrapper for C interpolation procedures</title>
<link rel='stylesheet' type='text/css' href='assets/ruff-min.css' />
<script type='text/javascript' src='assets/ruff-min.js'></script>
</head>
<body>
<div class='ruff-layout'>
<header class='ruff-layout-header ruff-hd'>
<a style='text-decoration:none;' href='index.html'>Tcl wrapper for C interpolation procedures (v0.14)</a>


            <div id="ruffButtonBar">
            <button id="ruffNavMove" onclick="ruffMoveNavPane()"></button>
            <button id="ruffToggleTheme" onclick="ruffNextTheme()"></button>
            </div>
        </header><main class='ruff-layout-main ruff-bd'><h1 class='ruff'><a name='::tclinterp::interpolation'></a>::tclinterp::interpolation<span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h1>
<div style='clear:both;'></div>
<h2 class='ruff'><a name='::tclinterp::interpolation-Commands'></a>Commands<span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h2>
<div style='clear:both;'></div>
<h3 class='ruffproc'><a name='::tclinterp::interpolation::cubicSpline1d'>cubicSpline1d</a><span class='ns_scope'> [<a href="index-tclinterp-interpolation.html#::tclinterp::interpolation" title="::tclinterp::interpolation" class='ruff_cmd'>::tclinterp::interpolation</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Does piecewise cubic spline interpolation.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>cubicSpline1d</span> <span class='ruff_arg'>?args?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>-deriv</code></td><td>Select the alternative output option.</td></tr>
<tr><td><code>-ibcbeg</code></td><td>Left boundary condition flag, -begflag is an alias. Possible values: <strong>quad</strong>, the cubic spline should be a quadratic over the first interval; <strong>der1</strong>, the first derivative at the left endpoint should be YBCBEG; <strong>der2</strong>, the second derivative at the left endpoint should be YBCBEG; <strong>notaknot</strong>, not-a-knot, the third derivative is continuous at T(2).</td></tr>
<tr><td><code>-ibcend</code></td><td>Right boundary condition flag, -endflag is an alias. Possible values: <strong>quad</strong>, the cubic spline should be a quadratic over the last interval; <strong>der1</strong>, the first derivative at the right endpoint should be YBCBEG; <strong>der2</strong>, the second derivative at the right endpoint should be YBCBEG; <strong>notaknot</strong>, not-a-knot, the third derivative is continuous at T(2).</td></tr>
<tr><td><code>-t</code></td><td>List of independent variable (t) values, -x is an alias.</td></tr>
<tr><td><code>-ti</code></td><td>List of independent variable interpolation (ti) values, -xi is an alias.</td></tr>
<tr><td><code>-y</code></td><td>List of dependent variable (y) values.</td></tr>
<tr><td><code>-ybcbeg</code></td><td>The values to be used in the boundary conditions if ibcbeg is equal to der1 or der2, default is 0.0.</td></tr>
<tr><td><code>-ybcend</code></td><td>The values to be used in the boundary conditions if ibcend is equal to der1 or der2, default is 0.0.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>list of interpolated dependent variable values under. If <code>-deriv</code> switch is in args, the output is dictionary that contains <code>yi</code> values under <code>yi</code> key, <code>yi</code> derivative under <code>yder1</code> key, and <code>yi</code> second derivative under <code>yder2</code> key.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_tclinterp_interpolation_cubicSpline1d' href="javascript:toggleSource('tclinterp_interpolation_cubicSpline1d')">Show source</a></p>
<div id='tclinterp_interpolation_cubicSpline1d' class='ruff_dyn_src'><pre>proc ::tclinterp::interpolation::cubicSpline1d {args} {

    # Does piecewise cubic spline interpolation.
    #  -ibcbeg - left boundary condition flag, -begflag is an alias. Possible values:
    #   **quad**, the cubic spline should be a quadratic over the first interval;
    #   **der1**, the first derivative at the left endpoint should be YBCBEG;
    #   **der2**, the second derivative at the left endpoint should be YBCBEG;
    #   **notaknot**, not-a-knot, the third derivative is continuous at T(2).
    #  -ibcend - right boundary condition flag, -endflag is an alias. Possible values:
    #   **quad**, the cubic spline should be a quadratic over the last interval;
    #   **der1**, the first derivative at the right endpoint should be YBCBEG;
    #   **der2**, the second derivative at the right endpoint should be YBCBEG;
    #   **notaknot**, not-a-knot, the third derivative is continuous at T(2).
    #  -ybcbeg - the values to be used in the boundary conditions if ibcbeg is equal to der1 or der2, default is 0.0
    #  -ybcend - the values to be used in the boundary conditions if ibcend is equal to der1 or der2, default is 0.0
    #  -t - list of independent variable (t) values, -x is an alias
    #  -y - list of dependent variable (y) values
    #  -ti - list of independent variable interpolation (ti) values, -xi is an alias
    #  -deriv - select the alternative output option
    # Returns: list of interpolated dependent variable values under. If `-deriv` switch is in args, the output is
    # dictionary that contains `yi` values under `yi` key, `yi` derivative under `yder1` key, and `yi` second derivative
    # under `yder2` key.
    argparse {
        {-ibcbeg= -default quad -enum {quad der1 der2 notaknot} -alias begflag}
        {-ibcend= -default quad -enum {quad der1 der2 notaknot} -alias endflag}
        {-ybcbeg= -default 0.0}
        {-ybcend= -default 0.0}
        {-t= -required -alias x}
        {-y= -required}
        {-ti= -required -alias xi}
        -deriv
    }
    set keyMap [dcreate quad 0 der1 1 der2 2 notaknot 3]
    set tLen [llength $t]
    set yLen [llength $y]
    set tiLen [llength $ti]
    if {$tLen!=$yLen} {
        return -code error &quot;Length of -y '$yLen' must be equal to length of -t '$tLen'&quot;
    } elseif {$tiLen==0} {
        return -code error &quot;Length of interpolation points list -ti must be more than zero&quot;
    }
    ::tclinterp::lists2arrays [list tArray yArray] [list $t $y]
    ::tclinterp::newArrays [list yppArray] [list $tLen]
    ::tclinterp::newDoubleps [list ypPnt yppPnt]
    set yppArray [::tclinterp::spline_cubic_set $tLen $tArray $yArray [dget $keyMap $ibcbeg] $ybcbeg [dget $keyMap $ibcend] $ybcend]
    for {set i 0} {$i&lt;$tiLen} {incr i} {
        set iElem [::tclinterp::spline_cubic_val $tLen $tArray $yArray $yppArray [@ $ti $i] $ypPnt $yppPnt]
        lappend yiList $iElem
        lappend ypList [::tclinterp::doublep_value $ypPnt]
        lappend yppList [::tclinterp::doublep_value $yppPnt]
    }
    ::tclinterp::deleteArrays $tArray $yArray $yppArray
    ::tclinterp::deleteDoubleps $ypPnt $yppPnt
    if {[info exists deriv]} {
        return [dict create yi $yiList yder1 $ypList yder2 $yppList]
    } else {
        return $yiList
    }
}</pre></div>
</div><h3 class='ruffproc'><a name='::tclinterp::interpolation::divDif1d'>divDif1d</a><span class='ns_scope'> [<a href="index-tclinterp-interpolation.html#::tclinterp::interpolation" title="::tclinterp::interpolation" class='ruff_cmd'>::tclinterp::interpolation</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Does divided difference one-dimensional interpolation.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>divDif1d</span> <span class='ruff_arg'>?args?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>-coeffs</code></td><td>Select the alternative output option.</td></tr>
<tr><td><code>-x</code></td><td>List of independent variable (x) values.</td></tr>
<tr><td><code>-xi</code></td><td>List of independent variable interpolation (xi) values.</td></tr>
<tr><td><code>-y</code></td><td>List of dependent variable (y) values.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>list of interpolated dependent variable values, <code>yi</code>, at <code>xi</code>. If <code>-coeffs</code> switch is in args, the output is dictionary that contains <code>yi</code> values under <code>yi</code> key, and the values of difference table under the key <code>coeffs</code>.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_tclinterp_interpolation_divDif1d' href="javascript:toggleSource('tclinterp_interpolation_divDif1d')">Show source</a></p>
<div id='tclinterp_interpolation_divDif1d' class='ruff_dyn_src'><pre>proc ::tclinterp::interpolation::divDif1d {args} {

    # Does divided difference one-dimensional interpolation.
    #  -x - list of independent variable (x) values
    #  -y - list of dependent variable (y) values
    #  -xi - list of independent variable interpolation (xi) values
    #  -coeffs - select the alternative output option
    # Returns: list of interpolated dependent variable values, `yi`, at `xi`. If `-coeffs` switch is in args, the output
    # is dictionary that contains `yi` values under `yi` key, and the values of difference table under the key `coeffs`.
    argparse {
        {-x= -required}
        {-y= -required}
        {-xi= -required}
        -coeffs
    }
    set xLen [llength $x]
    set yLen [llength $y]
    set xiLen [llength $xi]
    if {$xLen!=$yLen} {
        return -code error &quot;Length of -y '$yLen' must be equal to length of -x '$xLen'&quot;
    } elseif {$xiLen==0} {
        return -code error &quot;Length of interpolation points list -xi must be more than zero&quot;
    }
    if {[::tclinterp::duplListCheck $x]==&quot;true&quot;} {
        return -code error &quot;List of -x values must not contain duplicated elements&quot;
    }
    ::tclinterp::lists2arrays [list xArray yArray] [list $x $y]
    ::tclinterp::newArrays [list difTab] [list $xLen]
    # create difference table for given data
    ::tclinterp::data_to_dif $xLen $xArray $yArray $difTab
    # calculate polynomial value for each xi value
    for {set i 0} {$i&lt;$xiLen} {incr i} {
        set iElem [::tclinterp::dif_val $xLen $xArray $difTab [@ $xi $i]]
        lappend yiList $iElem
    }
    if {[info exists coeffs]} {
        ::tclinterp::arrays2lists [list difTabList] [list $difTab] [list $xLen]
        ::tclinterp::deleteArrays $difTab $xArray $yArray
        return [dcreate yi $yiList coeffs $difTabList]
    } else {
        ::tclinterp::deleteArrays $difTab $xArray $yArray
        return $yiList
    }
    return
}</pre></div>
</div><h3 class='ruffproc'><a name='::tclinterp::interpolation::hermiteSpline1d'>hermiteSpline1d</a><span class='ns_scope'> [<a href="index-tclinterp-interpolation.html#::tclinterp::interpolation" title="::tclinterp::interpolation" class='ruff_cmd'>::tclinterp::interpolation</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Does Hermite polynomial spline interpolation.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>hermiteSpline1d</span> <span class='ruff_arg'>?args?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>-deriv</code></td><td>Select the alternative output option.</td></tr>
<tr><td><code>-t</code></td><td>List of independent variable (t) values, must be strictly increasing, -x is an alias.</td></tr>
<tr><td><code>-ti</code></td><td>List of independent variable interpolation (ti) values, -xi is an alias.</td></tr>
<tr><td><code>-y</code></td><td>List of dependent variable (y) values.</td></tr>
<tr><td><code>-yp</code></td><td>List of dependent variable (y) derivative values.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>list of interpolated dependent variable values. If <code>-deriv</code> switch is in args, the output is dictionary that contains <code>yi</code> values under <code>yi</code> key, <code>yi</code> derivative under <code>yder1</code> key.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_tclinterp_interpolation_hermiteSpline1d' href="javascript:toggleSource('tclinterp_interpolation_hermiteSpline1d')">Show source</a></p>
<div id='tclinterp_interpolation_hermiteSpline1d' class='ruff_dyn_src'><pre>proc ::tclinterp::interpolation::hermiteSpline1d {args} {

    # Does Hermite polynomial spline interpolation.
    #  -t - list of independent variable (t) values, must be strictly increasing, -x is an alias
    #  -y - list of dependent variable (y) values
    #  -yp - list of dependent variable (y) derivative values
    #  -ti - list of independent variable interpolation (ti) values, -xi is an alias
    #  -deriv - select the alternative output option
    # Returns: list of interpolated dependent variable values. If `-deriv` switch is in args, the output is
    # dictionary that contains `yi` values under `yi` key, `yi` derivative under `yder1` key.
    argparse {
        {-t= -required -alias x}
        {-y= -required}
        {-yp= -required}
        {-ti= -required -alias xi}
        -deriv
    }
    set tLen [llength $t]
    set yLen [llength $y]
    set ypLen [llength $yp]
    set tiLen [llength $ti]
    if {$tLen!=$yLen} {
        return -code error &quot;Length of -y '$yLen' must be equal to length of -t '$tLen'&quot;
    } elseif {$tLen!=$ypLen} {
        return -code error &quot;Length of -yp '$ypLen' must be equal to length of -t '$tLen'&quot;
    } elseif {$tiLen==0} {
        return -code error &quot;Length of interpolation points list -ti must be more than zero&quot;
    }
    ::tclinterp::lists2arrays [list tArray yArray ypArray] [list $t $y $yp]
    if {[::tclinterp::r8vec_ascends_strictly $tLen $tArray]==0} {
        error &quot;Independent variable array -t is not strictly increasing&quot;
    }
    ::tclinterp::newArrays [list cArray] [list [= {$tLen*4}]]
    ::tclinterp::newDoubleps [list yiPnt yipPnt]
    set cArray [::tclinterp::spline_hermite_set $tLen $tArray $yArray $ypArray]
    for {set i 0} {$i&lt;$tiLen} {incr i} {
        ::tclinterp::spline_hermite_val $tLen $tArray $cArray [@ $ti $i] $yiPnt $yipPnt
        lappend yiList [::tclinterp::doublep_value $yiPnt]
        lappend yipList [::tclinterp::doublep_value $yipPnt]
    }
    ::tclinterp::deleteArrays $tArray $yArray $cArray $ypArray
    ::tclinterp::deleteDoubleps $yiPnt $yipPnt
    if {[info exists deriv]} {
        return [dict create yi $yiList yder1 $yipList]
    } else {
        return $yiList
    }
}</pre></div>
</div><h3 class='ruffproc'><a name='::tclinterp::interpolation::lagr1d'>lagr1d</a><span class='ns_scope'> [<a href="index-tclinterp-interpolation.html#::tclinterp::interpolation" title="::tclinterp::interpolation" class='ruff_cmd'>::tclinterp::interpolation</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Does Lagrange polynomial one-dimensional interpolation.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>lagr1d</span> <span class='ruff_arg'>?args?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>-x</code></td><td>List of independent variable (x) values.</td></tr>
<tr><td><code>-xi</code></td><td>List of independent variable interpolation (xi) values.</td></tr>
<tr><td><code>-y</code></td><td>List of dependent variable (y) values.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>list of interpolated dependent variable values, <code>yi</code>, at <code>xi</code></p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_tclinterp_interpolation_lagr1d' href="javascript:toggleSource('tclinterp_interpolation_lagr1d')">Show source</a></p>
<div id='tclinterp_interpolation_lagr1d' class='ruff_dyn_src'><pre>proc ::tclinterp::interpolation::lagr1d {args} {

    # Does Lagrange polynomial one-dimensional interpolation.
    #  -x - list of independent variable (x) values
    #  -y - list of dependent variable (y) values
    #  -xi - list of independent variable interpolation (xi) values
    # Returns: list of interpolated dependent variable values, `yi`, at `xi`
    argparse {
        {-x= -required}
        {-y= -required}
        {-xi= -required}
    }
    set xLen [llength $x]
    set yLen [llength $y]
    set xiLen [llength $xi]
    if {$xLen!=$yLen} {
        error &quot;Length of -y '$yLen' must be equal to length of -x '$xLen'&quot;
    } elseif {$xiLen==0} {
        error &quot;Length of interpolation points list -xi must be more than zero&quot;
    }
    ::tclinterp::lists2arrays [list xArray yArray xiArray] [list $x $y $xi]
    set yiArray [::tclinterp::interp_lagrange 1 $xLen $xArray $yArray $xiLen $xiArray]
    set yiList [::tclinterp::array2list $yiArray $xiLen]
    ::tclinterp::deleteArrays $xArray $yArray $xiArray $yiArray
    return $yiList
}</pre></div>
</div><h3 class='ruffproc'><a name='::tclinterp::interpolation::least1d'>least1d</a><span class='ns_scope'> [<a href="index-tclinterp-interpolation.html#::tclinterp::interpolation" title="::tclinterp::interpolation" class='ruff_cmd'>::tclinterp::interpolation</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Does least squares polynomial one-dimensional interpolation.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>least1d</span> <span class='ruff_arg'>?args?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>-coeffs</code></td><td>Select the alternative output option.</td></tr>
<tr><td><code>-nterms</code></td><td>Number of terms of interpolation polynom, default is 3.</td></tr>
<tr><td><code>-w</code></td><td>List of weights, optional.</td></tr>
<tr><td><code>-x</code></td><td>List of independent variable (x) values.</td></tr>
<tr><td><code>-xi</code></td><td>List of independent variable interpolation (xi) values.</td></tr>
<tr><td><code>-y</code></td><td>List of dependent variable (y) values.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>list of interpolated dependent variable values, <code>yi</code>, at <code>xi</code>. If <code>-coeffs</code> switch is in args, the output is dictionary that contains <code>yi</code> values under <code>yi</code> key, and the values of interpolation polynom coefficients under the keys <code>b</code>, <code>c</code> and <code>d</code>.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_tclinterp_interpolation_least1d' href="javascript:toggleSource('tclinterp_interpolation_least1d')">Show source</a></p>
<div id='tclinterp_interpolation_least1d' class='ruff_dyn_src'><pre>proc ::tclinterp::interpolation::least1d {args} {

    # Does least squares polynomial one-dimensional interpolation.
    #  -x - list of independent variable (x) values
    #  -y - list of dependent variable (y) values
    #  -xi - list of independent variable interpolation (xi) values
    #  -w - list of weights, optional
    #  -nterms - number of terms of interpolation polynom, default is 3
    #  -coeffs - select the alternative output option
    # Returns: list of interpolated dependent variable values, `yi`, at `xi`. If `-coeffs` switch is in args, the output
    # is dictionary that contains `yi` values under `yi` key, and the values of interpolation polynom coefficients under
    # the keys `b`, `c` and `d`.
    argparse {
        {-x= -required}
        {-y= -required}
        {-xi= -required}
        -w=
        {-nterms= -default 3}
        -coeffs
    }
    set xLen [llength $x]
    set yLen [llength $y]
    if {[info exists w]} {
        set wLen [llength $w]
    } else {
        set wLen [llength $x]
        set w [lrepeat $wLen 1]
    }
    set xiLen [llength $xi]
    if {$xLen!=$yLen} {
        return -code error &quot;Length of -y '$yLen' must be equal to length of -x '$xLen'&quot;
    } elseif {$xLen!=$wLen} {
        return -code error &quot;Length of -w '$wLen' must be equal to length of -x '$xLen'&quot;
    } elseif {$xiLen==0} {
        return -code error &quot;Length of interpolation points list -xi must be more than zero&quot;
    } elseif {[string is integer -strict $nterms]==0} {
        return -code error &quot;Number of terms -nterms '$nterms' must be of integer type&quot;
    } elseif {$nterms&lt;=0} {
        return -code error &quot;Number of terms -nterms must be more than zero&quot;
    }
    ::tclinterp::lists2arrays [list xArray yArray wArray xiArray] [list $x $y $w $xi]
    ::tclinterp::newArrays [list b c d] [list $nterms $nterms $nterms]
    # create polynomial coefficients for given data
    ::tclinterp::least_set $xLen $xArray $yArray $wArray $nterms $b $c $d
    # calculate polynomial value for each xi value
    for {set i 0} {$i&lt;$xiLen} {incr i} {
        set iElem [::tclinterp::least_val $nterms $b $c $d [@ $xi $i]]
        lappend yiList $iElem
    }
    if {[info exists coeffs]} {
        ::tclinterp::arrays2lists [list bList cList dList] [list $b $c $d] [list $nterms $nterms $nterms]
        ::tclinterp::deleteArrays $b $c $d $xArray $yArray $xiArray
        return [dcreate yi $yiList coeffs [dcreate b $bList c $cList d $dList]]
    } else {
        ::tclinterp::deleteArrays $b $c $d $xArray $yArray $xiArray
        return $yiList
    }
    return
}</pre></div>
</div><h3 class='ruffproc'><a name='::tclinterp::interpolation::least1dDer'>least1dDer</a><span class='ns_scope'> [<a href="index-tclinterp-interpolation.html#::tclinterp::interpolation" title="::tclinterp::interpolation" class='ruff_cmd'>::tclinterp::interpolation</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Does least squares polynomial one-dimensional interpolation with calculation of its derivative.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>least1dDer</span> <span class='ruff_arg'>?args?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>-coeffs</code></td><td>Select the alternative output option.</td></tr>
<tr><td><code>-nterms</code></td><td>Number of terms of interpolation polynom, default is 3.</td></tr>
<tr><td><code>-w</code></td><td>List of weights, optional.</td></tr>
<tr><td><code>-x</code></td><td>List of independent variable (x) values.</td></tr>
<tr><td><code>-xi</code></td><td>List of independent variable interpolation (xi) values.</td></tr>
<tr><td><code>-y</code></td><td>List of dependent variable (y) values.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>dict of interpolated dependent variable values and its derivatives under <code>yi</code> and <code>yiDer</code> keys. If <code>-coeffs</code> switch is in args, the output is dictionary that contains <code>yi</code> values under <code>yi</code> key, <code>yi</code> derivatives under <code>yiDer</code> key, and the values of interpolation polynom coefficients under the keys <code>b</code>, <code>c</code> and <code>d</code>.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_tclinterp_interpolation_least1dDer' href="javascript:toggleSource('tclinterp_interpolation_least1dDer')">Show source</a></p>
<div id='tclinterp_interpolation_least1dDer' class='ruff_dyn_src'><pre>proc ::tclinterp::interpolation::least1dDer {args} {

    # Does least squares polynomial one-dimensional interpolation with calculation of its derivative.
    #  -x - list of independent variable (x) values
    #  -y - list of dependent variable (y) values
    #  -xi - list of independent variable interpolation (xi) values
    #  -w - list of weights, optional
    #  -nterms - number of terms of interpolation polynom, default is 3
    #  -coeffs - select the alternative output option
    # Returns: dict of interpolated dependent variable values and its derivatives under `yi` and `yiDer` keys. If
    # `-coeffs` switch is in args, the output is dictionary that contains `yi` values under `yi` key, `yi` derivatives
    # under `yiDer` key, and the values of interpolation polynom coefficients under the keys `b`, `c` and `d`.
    argparse {
        {-x= -required}
        {-y= -required}
        {-xi= -required}
        -w=
        {-nterms= -default 3}
        -coeffs
    }
    set xLen [llength $x]
    set yLen [llength $y]
    if {[info exists w]} {
        set wLen [llength $w]
    } else {
        set wLen [llength $x]
        set w [lrepeat $wLen 1]
    }
    set xiLen [llength $xi]
    if {$xLen!=$yLen} {
        return -code error &quot;Length of -y '$yLen' must be equal to length of -x '$xLen'&quot;
    } elseif {$xLen!=$wLen} {
        return -code error &quot;Length of -w '$wLen' must be equal to length of -x '$xLen'&quot;
    } elseif {$xiLen==0} {
        return -code error &quot;Length of interpolation points list -xi must be more than zero&quot;
    } elseif {[string is integer -strict $nterms]==0} {
        return -code error &quot;Number of terms -nterms '$nterms' must be of integer type&quot;
    } elseif {$nterms&lt;=0} {
        return -code error &quot;Number of terms -nterms must be more than zero&quot;
    }
    ::tclinterp::lists2arrays [list xArray yArray wArray xiArray] [list $x $y $w $xi]
    ::tclinterp::newArrays [list b c d] [list $nterms $nterms $nterms]
    ::tclinterp::newDoubleps [list yiPnt yiDerPnt]
    # create polynomial coefficients for given data
    ::tclinterp::least_set $xLen $xArray $yArray $wArray $nterms $b $c $d
    # calculate polynomial value and derivative for each xi value
    for {set i 0} {$i&lt;$xiLen} {incr i} {
        ::tclinterp::least_val2 $nterms $b $c $d [@ $xi $i] $yiPnt $yiDerPnt
        lappend yiList [::tclinterp::doublep_value $yiPnt]
        lappend yiDerList [::tclinterp::doublep_value $yiDerPnt]
    }
    if {[info exists coeffs]} {
        ::tclinterp::arrays2lists [list bList cList dList] [list $b $c $d] [list $nterms $nterms $nterms]
        ::tclinterp::deleteArrays $b $c $d $xArray $yArray $xiArray
        ::tclinterp::deleteDoubleps $yiPnt $yiDerPnt
        return [dcreate yi $yiList yiDer $yiDerList coeffs [dcreate b $bList c $cList d $dList]]
    } else {
        ::tclinterp::deleteArrays $b $c $d $xArray $yArray $xiArray
        ::tclinterp::deleteDoubleps $yiPnt $yiDerPnt
        return [dcreate yi $yiList yiDer $yiDerList]
    }
    return
}</pre></div>
</div><h3 class='ruffproc'><a name='::tclinterp::interpolation::lin1d'>lin1d</a><span class='ns_scope'> [<a href="index-tclinterp-interpolation.html#::tclinterp::interpolation" title="::tclinterp::interpolation" class='ruff_cmd'>::tclinterp::interpolation</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Does linear one-dimensional interpolation.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>lin1d</span> <span class='ruff_arg'>?args?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>-x</code></td><td>List of independent variable (x) values, must be strictly increasing.</td></tr>
<tr><td><code>-xi</code></td><td>List of independent variable interpolation (xi) values.</td></tr>
<tr><td><code>-y</code></td><td>List of dependent variable (y) values.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>list of interpolated dependent variable values, <code>yi</code>, at <code>xi</code></p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_tclinterp_interpolation_lin1d' href="javascript:toggleSource('tclinterp_interpolation_lin1d')">Show source</a></p>
<div id='tclinterp_interpolation_lin1d' class='ruff_dyn_src'><pre>proc ::tclinterp::interpolation::lin1d {args} {

    # Does linear one-dimensional interpolation.
    #  -x - list of independent variable (x) values, must be strictly increasing
    #  -y - list of dependent variable (y) values
    #  -xi - list of independent variable interpolation (xi) values
    # Returns: list of interpolated dependent variable values, `yi`, at `xi`
    argparse {
        {-x= -required}
        {-y= -required}
        {-xi= -required}
    }
    set xLen [llength $x]
    set yLen [llength $y]
    set xiLen [llength $xi]
    if {$xLen!=$yLen} {
        error &quot;Length of -y '$yLen' must be equal to length of -x '$xLen'&quot;
    } elseif {$xiLen==0} {
        error &quot;Length of interpolation points list -xi must be more than zero&quot;
    }
    ::tclinterp::lists2arrays [list xArray yArray xiArray] [list $x $y $xi]
    if {[::tclinterp::r8vec_ascends_strictly $xLen $xArray]==0} {
        error &quot;Independent variable array -x is not strictly increasing&quot;
    }
    set yiArray [::tclinterp::interp_linear 1 $xLen $xArray $yArray $xiLen $xiArray]
    set yiList [::tclinterp::array2list $yiArray $xiLen]
    ::tclinterp::deleteArrays $xArray $yArray $xiArray $yiArray
    return $yiList
}</pre></div>
</div><h3 class='ruffproc'><a name='::tclinterp::interpolation::near1d'>near1d</a><span class='ns_scope'> [<a href="index-tclinterp-interpolation.html#::tclinterp::interpolation" title="::tclinterp::interpolation" class='ruff_cmd'>::tclinterp::interpolation</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Does nearest one-dimensional interpolation.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>near1d</span> <span class='ruff_arg'>?args?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>-x</code></td><td>List of independent variable (x) values.</td></tr>
<tr><td><code>-xi</code></td><td>List of independent variable interpolation (xi) values.</td></tr>
<tr><td><code>-y</code></td><td>List of dependent variable (y) values.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>list of interpolated dependent variable values, <code>yi</code>, at <code>xi</code></p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_tclinterp_interpolation_near1d' href="javascript:toggleSource('tclinterp_interpolation_near1d')">Show source</a></p>
<div id='tclinterp_interpolation_near1d' class='ruff_dyn_src'><pre>proc ::tclinterp::interpolation::near1d {args} {

    # Does nearest one-dimensional interpolation.
    #  -x - list of independent variable (x) values
    #  -y - list of dependent variable (y) values
    #  -xi - list of independent variable interpolation (xi) values
    # Returns: list of interpolated dependent variable values, `yi`, at `xi`
    argparse {
        {-x= -required}
        {-y= -required}
        {-xi= -required}
    }
    set xLen [llength $x]
    set yLen [llength $y]
    set xiLen [llength $xi]
    if {$xLen!=$yLen} {
        error &quot;Length of -y '$yLen' must be equal to length of -x '$xLen'&quot;
    } elseif {$xiLen==0} {
        error &quot;Length of interpolation points list -xi must be more than zero&quot;
    }
    ::tclinterp::lists2arrays [list xArray yArray xiArray] [list $x $y $xi]
    set yiArray [::tclinterp::interp_nearest 1 $xLen $xArray $yArray $xiLen $xiArray]
    set yiList [::tclinterp::array2list $yiArray $xiLen]
    ::tclinterp::deleteArrays $xArray $yArray $xiArray $yiArray
    return $yiList
}</pre></div>
</div><h3 class='ruffproc'><a name='::tclinterp::interpolation::pchip1d'>pchip1d</a><span class='ns_scope'> [<a href="index-tclinterp-interpolation.html#::tclinterp::interpolation" title="::tclinterp::interpolation" class='ruff_cmd'>::tclinterp::interpolation</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Does piecewise cubic Hermite interpolation (PCHIP).</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>pchip1d</span> <span class='ruff_arg'>?args?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>-f</code></td><td>List of dependent variable (f) values, -y is an alias.</td></tr>
<tr><td><code>-x</code></td><td>List of independent variable (x) values, must be strictly increasing.</td></tr>
<tr><td><code>-xe</code></td><td>List of independent variable interpolation (xe) values, -xi is an alias.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>list of interpolated dependent variable values.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_tclinterp_interpolation_pchip1d' href="javascript:toggleSource('tclinterp_interpolation_pchip1d')">Show source</a></p>
<div id='tclinterp_interpolation_pchip1d' class='ruff_dyn_src'><pre>proc ::tclinterp::interpolation::pchip1d {args} {

    # Does piecewise cubic Hermite interpolation (PCHIP).
    #  -x - list of independent variable (x) values, must be strictly increasing
    #  -f - list of dependent variable (f) values, -y is an alias
    #  -xe - list of independent variable interpolation (xe) values, -xi is an alias
    # Returns: list of interpolated dependent variable values.
    argparse {
        {-x= -required}
        {-f= -required -alias y}
        {-xe= -required -alias xi}
    }
    set xLen [llength $x]
    set fLen [llength $f]
    set xeLen [llength $xe]
    if {$xLen!=$fLen} {
        return -code error &quot;Length of -f '$fLen' must be equal to length of -x '$xLen'&quot;
    } elseif {$xeLen==0} {
        return -code error &quot;Length of interpolation points list -xe must be more than zero&quot;
    }
    ::tclinterp::lists2arrays [list xArray fArray xeArray] [list $x $f $xe]
    if {[::tclinterp::r8vec_ascends_strictly $xLen $xArray]==0} {
        error &quot;Independent variable array -x is not strictly increasing&quot;
    }
    ::tclinterp::newArrays [list dArray feArray] [list $xLen $xeLen]
    ::tclinterp::spline_pchip_set $xLen $xArray $fArray $dArray
    ::tclinterp::spline_pchip_val $xLen $xArray $fArray $dArray $xeLen $xeArray $feArray
    set feList [::tclinterp::array2list $feArray $xeLen]
    ::tclinterp::deleteArrays $xArray $fArray $dArray $xeArray $feArray
    return $feList
}</pre></div>
</div></main><nav class='ruff-nav'><ul ><li class='ruff-toc1'><a style='padding-top:2px;' href='index.html'>Start page</a></li>
<li class='ruff-toc1'><a href='index-docindex.html' accesskey='i'>Index</a></li>
<hr>
<li class='ruff-toc1'><a href='index-tclinterp.html'>tclinterp</a></li>
<li class='ruff-toc1'><a href='index-tclinterp-approximation.html'>tclinterp::approximation</a></li>
<li class='ruff-toc1'><a class='ruff-highlight' href='index-tclinterp-interpolation.html'>tclinterp::interpolation</a></li>
<hr><li class='ruff-toc2'><a href='#::tclinterp::interpolation-Commands'>Commands</a></li><li class='ruff-toc3 ruff-tip'><a href='index-tclinterp-interpolation.html#::tclinterp::interpolation::cubicSpline1d'>cubicSpline1d</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>cubicSpline1d</span> <span class='ruff_arg'>?args?</span></pre>Does piecewise cubic spline interpolation.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-tclinterp-interpolation.html#::tclinterp::interpolation::divDif1d'>divDif1d</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>divDif1d</span> <span class='ruff_arg'>?args?</span></pre>Does divided difference one-dimensional interpolation.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-tclinterp-interpolation.html#::tclinterp::interpolation::hermiteSpline1d'>hermiteSpline1d</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>hermiteSpline1d</span> <span class='ruff_arg'>?args?</span></pre>Does Hermite polynomial spline interpolation.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-tclinterp-interpolation.html#::tclinterp::interpolation::lagr1d'>lagr1d</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>lagr1d</span> <span class='ruff_arg'>?args?</span></pre>Does Lagrange polynomial one-dimensional interpolation.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-tclinterp-interpolation.html#::tclinterp::interpolation::least1d'>least1d</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>least1d</span> <span class='ruff_arg'>?args?</span></pre>Does least squares polynomial one-dimensional interpolation.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-tclinterp-interpolation.html#::tclinterp::interpolation::least1dDer'>least1dDer</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>least1dDer</span> <span class='ruff_arg'>?args?</span></pre>Does least squares polynomial one-dimensional interpolation with calculation of its derivative.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-tclinterp-interpolation.html#::tclinterp::interpolation::lin1d'>lin1d</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>lin1d</span> <span class='ruff_arg'>?args?</span></pre>Does linear one-dimensional interpolation.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-tclinterp-interpolation.html#::tclinterp::interpolation::near1d'>near1d</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>near1d</span> <span class='ruff_arg'>?args?</span></pre>Does nearest one-dimensional interpolation.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-tclinterp-interpolation.html#::tclinterp::interpolation::pchip1d'>pchip1d</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>pchip1d</span> <span class='ruff_arg'>?args?</span></pre>Does piecewise cubic Hermite interpolation (PCHIP).
</span></li></ul></nav><footer class='ruff-layout-footer ruff-ft'><div style='float: right;'>Document generated by <a href='https://ruff.magicsplat.com'>Ruff!</a></div><div>&copy; George Yashin</div></footer>
</div></body></html>
